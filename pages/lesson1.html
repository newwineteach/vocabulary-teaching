<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™®æ™®é¢¨æ¸¬é©—ï¼šVARKå­¸ç¿’é¢¨æ ¼æ¸¬è©¦</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Noto+Sans+TC:wght@500;700;900&display=swap"
        rel="stylesheet">
    <style>
        /* è‡ªå®šç¾©æ™®æ™®è—è¡“é¢¨æ ¼è¨­å®š */
        :root {
            --pop-yellow: #FFF200;
            --pop-red: #ED1C24;
            --pop-blue: #00AEEF;
            --pop-black: #000000;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--pop-blue);
            background-image: radial-gradient(var(--pop-black) 20%, transparent 20%),
                radial-gradient(var(--pop-black) 20%, transparent 20%);
            background-color: #ffffff;
            background-position: 0 0, 10px 10px;
            background-size: 20px 20px;
            overflow: hidden;
        }

        .comic-font {
            font-family: 'Bangers', 'Noto Sans TC', cursive;
            letter-spacing: 1px;
        }

        /* æ¼«ç•«å°è©±æ¡†è£é£¾ */
        .speech-bubble {
            position: relative;
            background: #fff;
            border: 4px solid #000;
            padding: 10px 20px;
            box-shadow: 8px 8px 0 #000;
            font-weight: 900;
        }

        /* é¸é …æŒ‰éˆ•æ¨£å¼ */
        .option-btn {
            background-color: white;
            border: 4px solid black;
            padding: 1rem;
            margin-bottom: 0.75rem;
            width: 100%;
            text-align: left;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 6px 6px 0px black;
            transition: all 0.1s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .option-btn:hover {
            transform: translate(-2px, -2px);
            box-shadow: 8px 8px 0px black;
            background-color: var(--pop-yellow);
        }

        .option-btn:active {
            transform: translate(4px, 4px);
            box-shadow: 2px 2px 0px black;
            background-color: var(--pop-red);
            color: white;
        }

        /* é¡Œç›®å¡ç‰‡å®¹å™¨ */
        .quiz-card {
            background: white;
            border: 6px solid black;
            padding: 2rem;
            box-shadow: 12px 12px 0px black;
            max-width: 600px;
            width: 90%;
            position: relative;
            z-index: 10;
        }

        /* é€²åº¦æ¢ */
        .progress-bar-container {
            width: 100%;
            height: 20px;
            border: 3px solid black;
            background: white;
            margin-top: 1rem;
            border-radius: 999px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--pop-red);
            width: 0%;
            transition: width 0.3s ease;
            border-right: 3px solid black;
        }

        /* çµæœé ç‰¹æ•ˆ */
        .result-burst {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 200vw;
            height: 200vw;
            background: radial-gradient(circle, var(--pop-yellow) 20%, var(--pop-red) 80%);
            z-index: 5;
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
        }

        .show-burst {
            transform: translate(-50%, -50%) scale(1) rotate(180deg);
        }

        /* å½©è™¹å‹•ç•«ç‰¹æ•ˆ (éŸ³æ¨‚) */
        @keyframes rainbow-border {
            0% {
                border-color: red;
                box-shadow: 0 0 10px red;
            }

            15% {
                border-color: orange;
                box-shadow: 0 0 10px orange;
            }

            30% {
                border-color: yellow;
                box-shadow: 0 0 10px yellow;
            }

            45% {
                border-color: green;
                box-shadow: 0 0 10px green;
            }

            60% {
                border-color: blue;
                box-shadow: 0 0 10px blue;
            }

            75% {
                border-color: indigo;
                box-shadow: 0 0 10px indigo;
            }

            90% {
                border-color: violet;
                box-shadow: 0 0 10px violet;
            }

            100% {
                border-color: red;
                box-shadow: 0 0 10px red;
            }
        }

        .rainbow-active {
            animation: rainbow-border 2s linear infinite;
            border-width: 4px;
            border-style: solid;
        }

        /* é–‹å§‹é®ç½© */
        #startOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        /* åˆ‡æ›å‹•ç•« */
        .fade-out {
            opacity: 0;
            transform: scale(0.9);
            transition: all 0.3s;
        }

        .fade-in {
            opacity: 1;
            transform: scale(1);
            transition: all 0.3s;
        }
    </style>
</head>

<body class="h-screen w-screen flex flex-col items-center justify-center p-4">

    <!-- é»æ“Šé–‹å§‹é®ç½© -->
    <div id="startOverlay">
        <h1 class="text-white text-5xl comic-font mb-4 text-center">ä½ çš„å¤§è…¦å–œæ­¡æ€éº¼å­¸ï¼Ÿ</h1>
        <button onclick="startApp()"
            class="comic-font text-4xl bg-yellow-400 text-black border-8 border-black p-6 hover:scale-110 transition-transform shadow-[10px_10px_0px_white]">
            START TEST!
        </button>
        <p class="text-white mt-8 font-bold">é–‹å•ŸéŸ³æ•ˆä»¥ç²å¾—æœ€ä½³é«”é©—</p>
    </div>

    <!-- èƒŒæ™¯è£é£¾ -->
    <div
        class="fixed top-[-50px] right-[-50px] w-64 h-64 bg-blue-400 rounded-full border-4 border-black z-0 opacity-50">
    </div>
    <div class="fixed bottom-10 left-10 w-32 h-32 bg-red-500 clip-polygon z-0"
        style="clip-path: polygon(50% 0%, 0% 100%, 100% 100%);"></div>

    <!-- çµæœé çˆ†ç‚¸ç‰¹æ•ˆèƒŒæ™¯ -->
    <div id="resultBurst" class="result-burst"></div>

    <!-- è¿”å›ä¸»é æŒ‰éˆ• (å·¦ä¸Šè§’) -->
    <a href="../index.html"
        class="fixed top-4 left-4 z-50 bg-white hover:bg-yellow-400 text-black font-bold px-4 py-2 border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:translate-x-1 hover:translate-y-1 transition-all rounded flex items-center gap-2">
        <span class="text-xl">â†</span>
        <span class="hidden md:inline">è¿”å›ä¸»é </span>
    </a>

    <!-- éŸ³æ¨‚æ’­æ”¾å™¨ (å³ä¸Šè§’) -->
    <div class="fixed top-4 right-4 z-50 flex flex-col items-end gap-1">
        <div id="audioStatus" class="bg-black text-white text-xs px-2 py-1 font-bold">ç­‰å¾…å•Ÿå‹•...</div>
        <div class="flex items-center gap-2">
            <button id="musicToggle"
                class="w-12 h-12 bg-white rounded-full flex items-center justify-center transition-all shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] border-4 border-black">
                <span id="musicIcon" class="text-2xl">ğŸµ</span>
            </button>
        </div>
    </div>

    <!-- æ¨™é¡Œå€ (æ¸¬é©—é€²è¡Œæ™‚é¡¯ç¤º) -->
    <div id="headerArea" class="mb-6 text-center relative z-10">
        <div class="speech-bubble inline-block bg-white transform -rotate-2">
            <h1 class="text-3xl md:text-5xl comic-font text-black tracking-wider">
                STYLE <span class="text-red-600">TEST</span>
            </h1>
        </div>
    </div>

    <!-- æ¸¬é©—å€åŸŸ -->
    <div id="quizContainer" class="quiz-card hidden">
        <div class="flex justify-between items-center mb-4">
            <span class="font-black text-xl bg-black text-white px-2 py-1 transform -skew-x-12">Question <span
                    id="qIndex">1</span></span>
        </div>

        <h2 id="questionText" class="text-2xl font-bold mb-6 leading-relaxed">
            é¡Œç›®è¼‰å…¥ä¸­...
        </h2>

        <div id="optionsContainer" class="flex flex-col gap-2">
            <!-- é¸é …æŒ‰éˆ•æœƒç”± JS ç”Ÿæˆ -->
        </div>

        <div class="progress-bar-container">
            <div id="progressBar" class="progress-bar"></div>
        </div>
    </div>

    <!-- çµæœå€åŸŸ -->
    <div id="resultContainer" class="relative z-20 text-center hidden max-w-2xl">
        <div class="bg-white border-8 border-black p-8 shadow-[15px_15px_0px_black] transform rotate-1">
            <h2 class="text-2xl font-bold mb-2">ä½ çš„å­¸ç¿’é¢¨æ ¼æ˜¯...</h2>
            <h1 id="resultTitle"
                class="text-5xl md:text-7xl comic-font text-red-600 mb-4 drop-shadow-[2px_2px_0px_black]">
                VISUAL
            </h1>
            <div id="resultDesc" class="text-xl font-bold bg-yellow-100 p-4 border-2 border-black text-left">
                åˆ†æçµæœèªªæ˜...
            </div>

            <button onclick="location.reload()"
                class="mt-8 bg-black text-white text-xl font-bold py-3 px-8 hover:bg-gray-800 border-2 border-white shadow-[4px_4px_0px_gray]">
                å†ä¾†ä¸€æ¬¡ (RETRY)
            </button>
        </div>
    </div>

    <!-- éŸ³è¨Šè³‡æº -->
    <audio id="bgMusic" loop preload="auto">
        <source
            src="https://raw.githubusercontent.com/hongruhuang29-arch/music-mp3/main/River%20of%20Tomorrows%20(Cover).mp3"
            type="audio/mpeg">
    </audio>

    <script>
        // VARK å­¸ç¿’é¢¨æ ¼é¡Œåº« (V=Visual, A=Aural, R=Read/Write, K=Kinesthetic)
        const quizData = [
            {
                question: "ç•¶ä½ æ‹¿åˆ°ä¸€æ”¯åŠŸèƒ½è¤‡é›œçš„æ–°æ‰‹æ©Ÿæ™‚ï¼Œä½ æœƒæ€éº¼åšï¼Ÿ",
                options: [
                    { text: "çœ‹è‘—åœ–ç¤ºæˆ–ç…§ç‰‡ä¾†æ‘¸ç´¢åŠŸèƒ½", type: "V" },
                    { text: "è½æœ‹å‹ä»‹ç´¹æˆ–æ˜¯æ‰¾æ•™å­¸å½±ç‰‡è½è§£èªª", type: "A" },
                    { text: "é–±è®€ä½¿ç”¨æ‰‹å†Šæˆ–ç¶²è·¯ä¸Šçš„æ–‡å­—èªªæ˜", type: "R" },
                    { text: "ç›´æ¥æŒ‰æŒ‰çœ‹ï¼Œè©¦éŒ¯ä¸­å­¸ç¿’", type: "K" }
                ]
            },
            {
                question: "ä½ è¿·è·¯äº†ï¼Œé€™æ™‚ä½ æœƒå‚¾å‘ï¼Ÿ",
                options: [
                    { text: "çœ‹åœ°åœ– (Google Maps çš„ç•«é¢)", type: "V" },
                    { text: "å•è·¯äººï¼Œè½ä»–å€‘çš„æŒ‡ç¤º", type: "A" },
                    { text: "çœ‹è·¯æ¨™æˆ–é–€ç‰Œä¸Šçš„æ–‡å­—", type: "R" },
                    { text: "æ†‘ç›´è¦ºèµ°èµ°çœ‹ï¼Œæˆ–æ‰¾åœ°æ¨™", type: "K" }
                ]
            },
            {
                question: "è¨ˆç•«å»æ—…è¡Œï¼Œä½ æœ€å–œæ­¡é€éå“ªç¨®æ–¹å¼åšåŠŸèª²ï¼Ÿ",
                options: [
                    { text: "çœ‹IGç¾ç…§æˆ–æ—…éŠå½±ç‰‡", type: "V" },
                    { text: "è·Ÿå»éçš„æœ‹å‹èŠå¤©è¨è«–", type: "A" },
                    { text: "é–±è®€æ—…éŠéƒ¨è½æ ¼æˆ–æ—…éŠæ›¸", type: "R" },
                    { text: "ä¸ç®¡é‚£éº¼å¤šï¼Œå»äº†å†é«”é©—", type: "K" }
                ]
            },
            {
                question: "è¦å­¸ç¿’ä¸€é“æ–°æ–™ç†ï¼Œä½ åå¥½ï¼Ÿ",
                options: [
                    { text: "çœ‹é£Ÿè­œä¸Šçš„å®Œæˆåœ–å’Œæ­¥é©Ÿç…§ç‰‡", type: "V" },
                    { text: "ä¸€é‚Šè½è€å¸«è§£èªªä¸€é‚Šçœ‹ç¤ºç¯„", type: "A" },
                    { text: "é–±è®€é£Ÿè­œæ›¸ä¸Šçš„è©³ç´°æ–‡å­—æ­¥é©Ÿ", type: "R" },
                    { text: "ç›´æ¥é€²å»šæˆ¿å‹•æ‰‹åšåšçœ‹", type: "K" }
                ]
            },
            {
                question: "åœ¨è€ƒè©¦å‰è¤‡ç¿’ï¼Œä½ ç¿’æ…£ï¼Ÿ",
                options: [
                    { text: "ç•«åœ–è¡¨ã€å¿ƒæ™ºåœ–ä¾†è¨˜æ†¶", type: "V" },
                    { text: "æŠŠé‡é»å”¸å‡ºä¾†ï¼Œæˆ–æ˜¯è·ŸåŒå­¸è¨è«–", type: "A" },
                    { text: "åè¦†é–±è®€ç­†è¨˜å’Œèª²æœ¬æ–‡å­—", type: "R" },
                    { text: "æŠŠè€ƒå¤é¡Œå¯«å¹¾éï¼Œæˆ–é€éå¯¦ä½œç·´ç¿’", type: "K" }
                ]
            }
        ];

        // å­¸ç¿’é¢¨æ ¼çµæœèªªæ˜
        const resultTypes = {
            "V": {
                title: "è¦–è¦ºå‹ (Visual)",
                desc: "ğŸ‘€ ä½ æ˜¯è¦–è¦ºå‹•ç‰©ï¼ä½ å–œæ­¡é€éåœ–ç‰‡ã€åœ–è¡¨ã€å½±ç‰‡å’Œé¡è‰²ä¾†å­¸ç¿’ã€‚å°ä½ ä¾†èªªï¼Œä¸€å¼µåœ–å‹éåƒè¨€è¬èªã€‚å»ºè­°ä½¿ç”¨è¢å…‰ç­†ã€å¿ƒæ™ºåœ–ä¾†è¼”åŠ©è¨˜æ†¶ã€‚"
            },
            "A": {
                title: "è½è¦ºå‹ (Aural)",
                desc: "ğŸ‘‚ ä½ æ“æœ‰ä¸€é›™é †é¢¨è€³ï¼ä½ å–œæ­¡é€éè†è½ã€è¨è«–å’Œå£è¿°ä¾†å­¸ç¿’ã€‚è½åˆ¥äººè¬›è§£æˆ–è‡ªå·±å”¸å‡ºä¾†æœƒè®“ä½ è¨˜å¾—æ›´ç‰¢ã€‚å»ºè­°å¤šåƒèˆ‡è¨è«–æˆ–ä½¿ç”¨æœ‰è²æ›¸ã€‚"
            },
            "R": {
                title: "è®€å¯«å‹ (Read/Write)",
                desc: "ğŸ“ ä½ æ˜¯æ–‡å­—æŒæ§è€…ï¼ä½ å–œæ­¡é–±è®€æ–‡å­—è³‡è¨Šã€å¯«ç­†è¨˜å’Œåˆ—è¡¨ã€‚å°æ–‡å­—çš„æ•æ„Ÿåº¦é«˜ï¼Œé–±è®€æ•™ç§‘æ›¸å°ä½ ä¾†èªªæœ€æœ‰æ•ˆç‡ã€‚å»ºè­°å¤šåšç­†è¨˜ã€å°‡åœ–è¡¨è½‰åŒ–ç‚ºæ–‡å­—ã€‚"
            },
            "K": {
                title: "å‹•è¦ºå‹ (Kinesthetic)",
                desc: "âœ‹ ä½ æ˜¯å¯¦è¸å®¶ï¼ä½ å–œæ­¡å‹•æ‰‹åšã€è¦ªèº«é«”é©—å’Œå¾éŒ¯èª¤ä¸­å­¸ç¿’ã€‚åè‘—è½èª²å°ä½ ä¾†èªªå¾ˆç—›è‹¦ï¼Œç›´æ¥æ“ä½œæœ€å¿«ä¸Šæ‰‹ã€‚å»ºè­°é€éå¯¦é©—ã€æ¨¡æ“¬æƒ…å¢ƒæˆ–é‚Šèµ°å‹•é‚ŠèƒŒèª¦ä¾†å­¸ç¿’ã€‚"
            }
        };

        let currentQuestion = 0;
        let scores = { V: 0, A: 0, R: 0, K: 0 };
        let audioContext = null;
        let playPromise = undefined;

        const bgMusic = document.getElementById('bgMusic');
        const musicToggle = document.getElementById('musicToggle');
        const musicIcon = document.getElementById('musicIcon');
        const audioStatus = document.getElementById('audioStatus');

        const quizContainer = document.getElementById('quizContainer');
        const resultContainer = document.getElementById('resultContainer');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const qIndex = document.getElementById('qIndex');
        const progressBar = document.getElementById('progressBar');
        const headerArea = document.getElementById('headerArea');
        const resultBurst = document.getElementById('resultBurst');

        function startApp() {
            document.getElementById('startOverlay').style.display = 'none';
            quizContainer.classList.remove('hidden');

            // Init Audio
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            audioContext = new AudioContext();

            safePlayMusic();
            loadQuestion();
        }

        function loadQuestion() {
            const data = quizData[currentQuestion];
            qIndex.textContent = currentQuestion + 1;
            questionText.textContent = data.question;

            // æ›´æ–°é€²åº¦æ¢
            const progress = ((currentQuestion) / quizData.length) * 100;
            progressBar.style.width = `${progress}%`;

            optionsContainer.innerHTML = '';

            // éš¨æ©Ÿæ’åˆ—é¸é …ï¼Œé¿å…å›ºå®šä½ç½®
            const shuffledOptions = [...data.options].sort(() => Math.random() - 0.5);

            shuffledOptions.forEach((opt, index) => {
                const btn = document.createElement('div');
                btn.className = 'option-btn comic-font';
                // åŠ å…¥ä¸€é»éš¨æ©Ÿæ—‹è½‰ï¼Œå¢åŠ æ¼«ç•«æ„Ÿ
                const rotate = (Math.random() * 2 - 1).toFixed(1);
                btn.style.transform = `rotate(${rotate}deg)`;

                btn.innerHTML = `<span class="text-red-500 mr-2">${String.fromCharCode(65 + index)}.</span> ${opt.text}`;

                btn.onclick = () => handleAnswer(opt.type);
                optionsContainer.appendChild(btn);
            });
        }

        function handleAnswer(type) {
            playSwooshSound();
            scores[type]++;

            // å‹•ç•«éå ´
            quizContainer.classList.add('fade-out');

            setTimeout(() => {
                currentQuestion++;
                if (currentQuestion < quizData.length) {
                    loadQuestion();
                    quizContainer.classList.remove('fade-out');
                    quizContainer.classList.add('fade-in');
                    setTimeout(() => quizContainer.classList.remove('fade-in'), 300);
                } else {
                    showResult();
                }
            }, 300);
        }

        function showResult() {
            quizContainer.style.display = 'none';
            headerArea.style.display = 'none';

            // è¨ˆç®—æœ€é«˜åˆ†
            let maxScore = -1;
            let winner = 'V'; // é è¨­

            for (const [key, value] of Object.entries(scores)) {
                if (value > maxScore) {
                    maxScore = value;
                    winner = key;
                }
            }

            const resultData = resultTypes[winner];
            document.getElementById('resultTitle').textContent = resultData.title.split(' ')[0]; // åªå–ä¸­æ–‡æ¨™é¡Œ
            document.getElementById('resultDesc').textContent = resultData.desc;

            // é¡¯ç¤ºçµæœèˆ‡ç‰¹æ•ˆ
            resultBurst.classList.add('show-burst');
            resultContainer.classList.remove('hidden');
            resultContainer.classList.add('fade-in');

            // æ’­æ”¾å‹åˆ©éŸ³æ•ˆ (æ¨¡æ“¬)
            playWinSound();
        }

        // --- éŸ³è¨Šé‚è¼¯ (æ²¿ç”¨ä¹‹å‰çš„ç©©å®šç‰ˆæœ¬) ---

        function safePlayMusic() {
            bgMusic.volume = 0.4;
            playPromise = bgMusic.play();
            if (playPromise !== undefined) {
                playPromise.then(() => updateMusicUI(true))
                    .catch(e => { console.error(e); updateMusicUI(false); });
            }
        }

        function safePauseMusic() {
            if (playPromise !== undefined) {
                playPromise.then(() => { bgMusic.pause(); updateMusicUI(false); })
                    .catch(() => updateMusicUI(false));
            }
        }

        function updateMusicUI(isPlaying) {
            if (isPlaying) {
                musicIcon.textContent = "â¸";
                musicToggle.classList.add('rainbow-active');
                audioStatus.textContent = "ç‹€æ…‹: æ’­æ”¾ä¸­";
                audioStatus.style.color = "#00FF00";
            } else {
                musicIcon.textContent = "ğŸµ";
                musicToggle.classList.remove('rainbow-active');
                audioStatus.textContent = "ç‹€æ…‹: æš«åœ";
                audioStatus.style.color = "white";
            }
        }

        musicToggle.addEventListener('click', () => {
            if (bgMusic.paused) safePlayMusic();
            else safePauseMusic();
        });

        function playSwooshSound() {
            if (!audioContext) return;
            if (audioContext.state === 'suspended') audioContext.resume();
            const osc = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioContext.destination);

            const now = audioContext.currentTime;
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(200, now);
            osc.frequency.exponentialRampToValueAtTime(800, now + 0.1);
            gainNode.gain.setValueAtTime(0.3, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.2);

            osc.start(now);
            osc.stop(now + 0.2);
        }

        function playWinSound() {
            if (!audioContext) return;
            const now = audioContext.currentTime;

            // ç°¡å–®çš„ä¸‰å’Œå¼¦å‹åˆ©éŸ³æ•ˆ
            [440, 554, 659].forEach((freq, i) => {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                osc.connect(gain);
                gain.connect(audioContext.destination);

                osc.type = 'square';
                osc.frequency.value = freq;

                gain.gain.setValueAtTime(0, now);
                gain.gain.linearRampToValueAtTime(0.2, now + 0.1 + (i * 0.05));
                gain.gain.exponentialRampToValueAtTime(0.01, now + 1.5);

                osc.start(now);
                osc.stop(now + 1.5);
            });
        }
    </script>
</body>

</html>